'use strict';

import React from 'react';

import {
  Container,
  Button,
  TextField,
  LabelTextField,
  TextFieldCombo,
  Label,
  Badge,
  Calendar,
  Clock,
  Menu,
  FlyingBalloon,
  Separator,
  Ticket,
  TripTicket,
  TripTickets,
  MessengerTicket,
  DragController
} from 'electrum-arc';

export default class DispatchMessengers extends React.Component {

  constructor (props) {
    super (props);
  }

  getGlyphEntitySolo(glyph) {
    if (glyph) {
      return {
        Glyph:       glyph,
        Name:        'Glyph ' + glyph,
        Description: 'Generated by electrum-dev'
      };
    } else {
      return null;
    }
  }

  getGlyphEntity(glyph) {
    if (glyph) {
      return {
        id:     'foo',
        offset: 0,
        value:  {
          Glyph:       glyph,
          Name:        'Glyph ' + glyph,
          Description: 'Generated by electrum-dev'
        }};
    } else {
      return null;
    }
  }

  getGlyphEntities(glyphs) {
    if (glyphs) {
      var array = [];
      glyphs.forEach (g => {
        array.push (this.getGlyphEntity (g));
      });
      return array;
    } else {
      return null;
    }
  }

  getMessenger (color, data) {
    data.Photo          = this.getGlyphEntitySolo (data.Photo);
    data.Transportation = this.getGlyphEntitySolo (data.Transportation);
    return (
      <MessengerTicket Color={color} data={data} {...this.link ()} />
    );
  }

  getTrip (color, type, data) {
    data.Pick.Glyphs = this.getGlyphEntities (data.Pick.Glyphs);
    data.Drop.Glyphs = this.getGlyphEntities (data.Drop.Glyphs);
    if (!data.TicketId) {
      throw new Error (`Undefined Ticket.data.TicketId`);
    }
    const d = {
      Color:  color,
      Type:   type,
      Trip:   data,
      NoDrag: color === 'selected' ? 'true' : 'false'
    };

    return (
      <TripTicket data={d} {...this.link ()} />
    );
  }

  getTrips (tripId, data) {
    data.Pick.Glyphs = this.getGlyphEntities (data.Pick.Glyphs);
    data.Drop.Glyphs = this.getGlyphEntities (data.Drop.Glyphs);
    data.TripId = tripId;
    const dp = {
      Color:  null,
      Type:   'pick',
      Trip:   data,
      NoDrag: 'false'
    };
    const dd = {
      Color:  null,
      Type:   'drop',
      Trip:   data,
      NoDrag: 'false'
    };
    const d = {
      Pick: dp,
      Drop: dd,
    };
    d.Pick.Trip.TicketId = d.Pick.Trip.TripId + '-pick';
    d.Drop.Trip.TicketId = d.Drop.Trip.TripId + '-drop';
    if (!d.Pick.Trip.TicketId) {
      throw new Error (`Undefined Ticket.d.Pick.Trip.TicketId`);
    }
    if (!d.Drop.Trip.TicketId) {
      throw new Error (`Undefined Ticket.d.Drop.Trip.TicketId`);
    }

    return (
      <TripTickets data={d} {...this.link ()} />
    );
  }

  render () {
    return (
      <Container kind='tickets-root' {...this.link ()} >
        <DragController name='tickets' drag-handle='TripTicket' {...this.link ()} />
        <DragController name='messengers' direction='horizontal' drag-handle='MessengerTicket' {...this.link ()} />
        <Container kind='tickets-messengers' drag-controller='messengers' {...this.link ()} >
          <Container kind='tickets-messenger' {...this.link ()} >
            {this.getMessenger (null, {
              Photo:          'user',
              Transportation: 'bicycle',
              Name:           'Sandra',
              Total:          '203.50'})}
            <Container kind='tickets-trips' drag-controller='tickets' {...this.link ()} >
              {this.getTrips ('trips1', {
                Pick: {
                  Time: '13:30',
                  Description: 'Icomm',
                  Glyphs:   ['warning']},
                Drop: {
                  Time: '14:15',
                  Description: 'Studer AG',
                  Glyphs:   ['bookmark-secondary', 'bookmark-primary']},
                Count:    '1x'})}
              {this.getTrip ('selected', 'pick', {
                TicketId: '1',
                TripId: 't1',
                Pick: {
                  Time: '2016-03-31T10:51:00',
                  Description: 'Coop St. Laurent',
                  Glyphs:   ['warning']},
                Drop:  {
                  Time: '11:20',
                  Description: 'Dupond J.',
                  Zone: {Name: 'Zone A'}},
                Count:    '2x'})}
              {this.getTrip ('selected', 'drop', {
                TicketId: '2',
                TripId: 't2',
                Pick: {
                  Time: '11:00',
                  Description: 'Migros Pont-Neuf'},
                Drop: {
                  Time: '11:15',
                  Description: 'Burdet H.',
                  Glyphs:   ['warning', 'bookmark-base']},
                Count:    '1x'})}
              {this.getTrip (null, 'pick', {
                TicketId: '3',
                TripId: 't3',
                Pick: {
                  Time: '11:20',
                  Description: 'PolyAugrien'},
                Drop: {
                  Time: '11:45',
                  Description: 'Burdet A.',
                  Glyphs:   ['warning']},
                Count:    '3x'})}
              {this.getTrip (null, 'drop', {
                TicketId: '4',
                TripId: 't3',
                Pick: {
                  Time: '11:20',
                  Description: 'PolyAugrien'},
                Drop: {
                  Time: '11:45',
                  Description: 'Burdet A.',
                  Glyphs:   ['warning']},
                Count:    '3x'})}
              {this.getTrip (null, 'pick', {
                TicketId: '5',
                TripId: 't6',
                Pick: {
                  Time: '11:45',
                  Description: 'Mecano SA',
                  Zone: {Name: 'Zone B'}},
                Drop: {
                  Time: '13:00',
                  Description: 'Dubosson F.'},
                Count:    '1x'})}
              {this.getTrip (null, 'pick', {
                TicketId: '6',
                TripId: 't7',
                Pick: {
                  Time: '11:00',
                  Description: 'Migros Pont-Neuf'},
                Drop: {
                  Time: '11:15',
                  Description: 'Chancellerie',
                  Glyphs:   ['warning']},
                Count:    '1x'})}
            </Container>
          </Container>

          <Container kind='tickets-messenger' {...this.link ()} >
            {this.getMessenger (null, {
              Photo:          'user',
              Transportation: 'bicycle',
              Name:           'Jean-Paul',
              Total:          '68.00'})}
            <Container kind='tickets-trips' drag-controller='tickets' {...this.link ()} >
              {this.getTrip (null, 'pick', {
                TicketId: '7',
                TripId: 't11',
                Pick: {
                  Time: '13:30',
                  Description: 'Icomm'},
                Drop: {
                  Time: '14:15',
                  Description: 'Studer AG'},
                Count:    '4x'})}
              {this.getTrip (null, 'drop', {
                TicketId: '8',
                TripId: 't7',
                Pick: {
                  Time: '11:00',
                  Description: 'Migros Pont-Neuf'},
                Drop: {
                  Time: '11:15',
                  Description: 'Chancellerie',
                  Glyphs:   ['warning']},
                Count:    '1x'})}
              {this.getTrip ('red', 'pick', {
                TicketId: '9',
                TripId: 't5',
                Pick: {
                  Time: '11:45',
                  Description: 'Me Mouquin G.',
                  Glyphs:   ['warning', 'bookmark-base', 'bookmark-secondary', 'bookmark-primary']},
                Drop: {
                  Time: '13:00',
                  Description: 'Schmidt W.'},
                Count:    '1x'})}
              {this.getTrip (null, 'drop', {
                TicketId: '10',
                TripId: 't11',
                Pick: {
                  Time: '13:30',
                  Description: 'Icomm'},
                Drop: {
                  Time: '14:15',
                  Description: 'Studer AG'},
                Count:    '4x'})}
            </Container>
          </Container>

          <Container kind='tickets-messenger' {...this.link ()} >
            {this.getMessenger (null, {
              Photo:          'user-secret',
              Transportation: 'car',
              Name:           'Frédérique',
              Total:          '250.00'})}
            <Container kind='tickets-trips' drag-controller='tickets' {...this.link ()} >
              {this.getTrip ('selected', 'pick', {
                TicketId: '11',
                TripId: 't1',
                Pick: {
                  Time: '10:15',
                  Description: 'Coop St. Laurent',
                  Glyphs:   ['bookmark-primary']},
                Drop: {
                  Time: '10:55',
                  Description: 'Dupond J.'},
                Count:    '1x'})}
              {this.getTrip ('selected', 'pick', {
                TicketId: '12',
                TripId: 't2',
                Pick: {
                  Time: '11:00',
                  Description: 'Migros Pont-Neuf'},
                Drop: {
                  Time: '11:15',
                  Description: 'Burdet H.',
                  Glyphs:   ['warning', 'bookmark-base']},
                Count:    '1x'})}
              {this.getTrip ('selected', 'drop', {
                TicketId: '13',
                TripId: 't8',
                Pick: {
                  Time: '11:00',
                  Description: 'Migros Pont-Neuf'},
                Drop: {
                  Time: '11:15',
                  Description: 'Chancellerie',
                  Glyphs:   ['warning', 'bookmark-secondary']},
                Count:    '1x'})}
              {this.getTrip (null, 'drop', {
                TicketId: '14',
                TripId: 't6',
                Pick: {
                  Time: '11:45',
                  Description: 'Mecano SA',
                  Zone: {Name: 'Zone B'}},
                Drop: {
                  Time: '13:00',
                  Description: 'Dubosson F.'},
                Count:    '1x'})}
              {this.getTrip ('green', 'pick', {
                TicketId: '15',
                TripId: 't5',
                Pick: {
                  Time: '11:45',
                  Description: 'Me Mouquin G.'},
                Drop: {
                  Time: '13:00',
                  Description: 'Schmidt W.'},
                Count:    '2x'})}
              {this.getTrip (null, 'drop', {
                TicketId: '16',
                Pick: {
                  Time: '13:30',
                  Description: 'Icomm'},
                Drop: {
                  Time: '14:15',
                  Description: 'Studer AG'},
                Count:    '1x'})}
            </Container>
          </Container>

          <Container kind='tickets-messenger' {...this.link ()} >
            {this.getMessenger (null, {
      				Photo:          'user',
      				Transportation: 'bicycle',
      				Name:           'Marcel',
      				Total:          '0.00'})}
            <Container kind='tickets-trips' drag-controller='tickets' {...this.link ()} >
              {this.getTrip (null, 'pick', {
                TicketId: '17',
                TripId: 't8',
                Pick: {
                  Time: '11:00',
                  Description: 'Migros Pont-Neuf'},
                Drop: {
                  Time: '11:15',
                  Description: 'Chancellerie',
                  Glyphs:   ['warning', 'bookmark-secondary']},
                Count:    '1x'})}
              {this.getTrip (null, 'drop', {
                TicketId: '18',
                TripId: 't14',
                Pick: {
                  Time: '13:30',
                  Description: 'Icomm'},
                Drop: {
                  Time: '14:15',
                  Description: 'Studer AG'},
                Count:    '4x',
                Glyphs:   ['warning']})}
            </Container>
          </Container>

          <Container kind='tickets-messenger' {...this.link ()} >
            {this.getMessenger (null, {
      				Photo:          'user',
      				Transportation: 'truck',
      				Name:           'Simone',
      				Total:          '100.00'})}
            <Container kind='tickets-trips' drag-controller='tickets' {...this.link ()} >
              {this.getTrip (null, 'pick', {
                TicketId: '19',
                TripId: 't14',
                Pick: {
                  Time: '13:30',
                  Description: 'Icomm'},
                Drop: {
                  Time: '14:15',
                  Description: 'Studer AG'},
                Count:    '1x'})}
            </Container>
          </Container>

          <Container kind='tickets-messenger' {...this.link ()} >
            {this.getMessenger (null, {
            Photo:          'user',
            Transportation: 'bicycle',
            Name:           'Jean-Louis',
            Total:          '400.00'})}
            <Container kind='tickets-trips' drag-controller='tickets' {...this.link ()} >
              {this.getTrip (null, 'drop', {
                TicketId: '20',
                Pick: {
                  Time: '13:30',
                  Description: 'Icomm'},
                Drop: {
                  Time: '14:15',
                  Description: 'Studer AG',
                  Glyphs:   ['bookmark-primary']},
                Count:    '4x'})}
            </Container>
          </Container>

          <Container kind='tickets-messenger' {...this.link ()} >
            {this.getMessenger ('yellow', {
          		Photo:          'user',
            Transportation: 'bicycle',
            Name:           'Chantal',
            Total:          '95.20'})}
            <Container kind='tickets-trips' drag-controller='tickets' {...this.link ()} >
              {this.getTrip ('yellow', 'drop', {
                TicketId: '21',
                Pick: {
                  Time: '13:30',
                  Description: 'Icomm'},
                Drop: {
                  Time: '14:15',
                  Description: 'Studer AG',
                  Glyphs:   ['warning']},
                Count:    '1x'})}
              {this.getTrip ('yellow', 'drop', {
                TicketId: '22',
                Pick: {
                  Time: '11:00',
                  Description: 'Migros Pont-Neuf'},
                Drop: {
                  Time: '11:15',
                  Description: 'Chancellerie'},
                Count:    '1x'})}
              {this.getTrip (null, 'drop', {
                TicketId: '23',
                Pick: {
                  Time: '11:20',
                  Description: 'PolyAugrien'},
                Drop: {
                  Time: '11:45',
                  Description: 'Burdet A.'},
                Count:    '1x'})}
              {this.getTrip (null, 'pick', {
                TicketId: '24',
                Pick: {
                  Time: '11:45',
                  Description: 'Me Mouquin G.',
                  Glyphs:   ['bookmark-base', 'bookmark-secondary']},
                Drop: {
                  Time: '13:00',
                  Description: 'Schmidt W.'},
                Count:    '2x'})}
            </Container>
          </Container>

          <Container kind='tickets-messenger' {...this.link ()} >
            {this.getMessenger (null, {
          		Photo:          'user',
            Transportation: 'bicycle',
            Name:           'Béatrice',
            Total:          '20.00'})}
            <Container kind='tickets-trips' drag-controller='tickets' {...this.link ()} >
              {this.getTrip (null, 'drop', {
                TicketId: '25',
                Pick: {
                  Time: '13:30',
                  Description: 'Icomm'},
                Drop: {
                  Time: '14:15',
                  Description: 'Studer AG',
                  Glyphs:   ['warning']},
                Count:    '1x'})}
            </Container>
          </Container>

          <Container kind='tickets-messenger' {...this.link ()} >
            {this.getMessenger (null, {
          		Photo:          'user',
            Transportation: 'rocket',
            Name:           'Zoé',
            Total:          '0.00'})}
            <Container kind='tickets-trips' drag-controller='tickets' {...this.link ()} >
              {this.getTrip (null, 'drop', {
                TicketId: '26',
                Pick: {
                  Time: '13:30',
                  Description: 'Icomm'},
                Drop: {
                  Time: '14:15',
                  Description: 'Studer AG'},
                Count:    '2x'})}
            </Container>
          </Container>

          <Container kind='tickets-messenger' {...this.link ()} >
            {this.getMessenger (null, {
          		Photo:          'user',
            Transportation: 'bicycle',
            Name:           'Marc',
            Total:          '0.00'})}
            <Container kind='tickets-trips' drag-controller='tickets' {...this.link ()} >
              {this.getTrip (null, 'drop', {
                TicketId: '27',
                Pick: {
                  Time: '08:30',
                  Description: 'Icomm'},
                Drop: {
                  Time: '09:15',
                  Description: 'Studer AG',
                  Glyphs:   ['bookmark-secondary']},
        				Count:    '4x'})}
              {this.getTrip (null, 'pick', {
                TicketId: '28',
				        Pick: {
          				Time: '10:50',
          				Description: 'Coop St. Laurent'},
				        Drop: {
          				Time: '11:20',
          				Description: 'Dupond J.'},
        				Count:    '1x'})}
              {this.getTrip (null, 'drop', {
                TicketId: '29',
				        Pick: {
          				Time: '11:00',
          				Description: 'Migros Pont-Neuf'},
				        Drop: {
          				Time: '11:15',
          				Description: 'Chancellerie'},
        				Count:    '1x'})}
              {this.getTrip (null, 'drop', {
                TicketId: '30',
				        Pick: {
          				Time: '11:20',
          				Description: 'PolyAugrien'},
				        Drop: {
          				Time: '11:45',
          				Description: 'Burdet A.',
          				Glyphs:   ['warning']},
        				Count:    '3x'})}
              {this.getTrip (null, 'pick', {
                TicketId: '31',
				        Pick: {
          				Time: '11:45',
          				Description: 'Me Mouquin G.',
          				Glyphs:   ['bookmark-base', 'bookmark-primary']},
				        Drop: {
          				Time: '13:00',
          				Description: 'Schmidt W.'},
        				Count:    '1x'})}
              {this.getTrip (null, 'drop', {
                TicketId: '32',
				        Pick: {
          				Time: '13:30',
          				Description: 'Icomm'},
				        Drop: {
          				Time: '14:15',
          				Description: 'Studer AG',
          				Glyphs:   ['warning', 'bookmark-base', 'bookmark-secondary']},
        				Count:    '1x'})}
            </Container>
          </Container>

          <Container kind='tickets-messenger' {...this.link ()} >
            {this.getMessenger (null, {
          		Photo:          'user',
      				Transportation: 'bicycle',
      				Name:           'Victor',
      				Total:          '630.00'})}
            <Container kind='tickets-trips' drag-controller='tickets' {...this.link ()} >
              {this.getTrip (null, 'drop', {
                TicketId: '33',
				        Pick: {
          				Time: '13:30',
          				Description: 'Icomm'},
				        Drop: {
          				Time: '14:15',
          				Description: 'Studer AG'},
        				Count:    '1x'})}
            </Container>
          </Container>

          <Container kind='tickets-messenger' {...this.link ()} >
            {this.getMessenger (null, {
          		Photo:          'user',
      				Transportation: 'car',
      				Name:           'Jacques',
      				Total:          '0.00'})}
            <Container kind='tickets-trips' drag-controller='tickets' {...this.link ()} >
              {this.getTrip (null, 'drop', {
                TicketId: '34',
				        Pick: {
          				Time: '13:30',
          				Description: 'Icomm'},
				        Drop: {
          				Time: '14:15',
          				Description: 'Studer AG',
          				Glyphs:   ['warning']},
        				Count:    '2x'})}
              {this.getTrip (null, 'pick', {
                TicketId: '35',
				        Pick: {
          				Time: '10:50',
          				Description: 'Coop St. Laurent',
          				Glyphs:   ['warning', 'bookmark-primary']},
				        Drop: {
          				Time: '11:20',
          				Description: 'Dupond J.'},
        				Count:    '1x'})}
              {this.getTrip (null, 'drop', {
                TicketId: '36',
				        Pick: {
          				Time: '11:00',
          				Description: 'Migros Pont-Neuf'},
				        Drop: {
          				Time: '11:15',
          				Description: 'Chancellerie',
          				Glyphs:   ['warning']},
        				Count:    '1x'})}
            </Container>
          </Container>

          <Container kind='tickets-messenger' {...this.link ()} >
            {this.getMessenger (null, {
          		Photo:          'user',
      				Transportation: 'car',
      				Name:           'Samuel',
      				Total:          '0.00'})}
            <Container kind='tickets-trips' drag-controller='tickets' {...this.link ()} >
              {this.getTrip (null, 'drop', {
                TicketId: '37',
				        Pick: {
          				Time: '13:30',
          				Description: 'Icomm'},
				        Drop: {
          				Time: '14:15',
          				Description: 'Studer AG'},
        				Count:    '1x'})}
              {this.getTrip (null, 'pick', {
                TicketId: '38',
				        Pick: {
          				Time: '11:45',
          				Description: 'Me Mouquin G.',
          				Glyphs:   ['bookmark-base', 'bookmark-secondary', 'bookmark-primary']},
				        Drop: {
          				Time: '13:00',
          				Description: 'Schmidt W.'},
        				Count:    '2x'})}
            </Container>
          </Container>

          <Container kind='tickets-messenger' {...this.link ()} >
            {this.getMessenger (null, {
          		Photo:          'user',
      				Transportation: 'bicycle',
      				Name:           'Georges',
      				Total:          '50.00'})}
            <Container kind='tickets-trips' drag-controller='tickets' {...this.link ()} >
              {this.getTrip (null, 'drop', {
                TicketId: '39',
				        Pick: {
          				Time: '13:30',
          				Description: 'Icomm'},
				        Drop: {
          				Time: '14:15',
          				Description: 'Studer AG',
          				Glyphs:   ['warning']},
        				Count:    '4x'})}
            </Container>
          </Container>

          <Container kind='tickets-messenger' {...this.link ()} >
            {this.getMessenger (null, {
          		Photo:          'user',
      				Transportation: 'bicycle',
      				Name:           'Francine',
      				Total:          '68.00'})}
            <Container kind='tickets-trips' drag-controller='tickets' {...this.link ()} >
              {this.getTrip (null, 'drop', {
                TicketId: '40',
				        Pick: {
          				Time: '13:30',
          				Description: 'Icomm'},
				        Drop: {
          				Time: '14:15',
          				Description: 'Studer AG',
          				Glyphs:   ['warning']},
        				Count:    '1x'})}
            </Container>
          </Container>

        </Container>

        <Container kind='tickets-basket'  height='260px' {...this.link ()} >
          <Container kind='tickets-glue' left='30px' top='50px' rotate='10deg'
            min-width='220px' min-height='164px'
            drag-controller='tickets' {...this.link ()} >
            {this.getTrips ('trips10', {
              TicketId: '41',
				      Pick: {
        				Time: '13:30',
        				Description: 'Icomm'},
				      Drop: {
        				Time: '14:15',
        				Description: 'Studer AG'},
      				Count:    '2x'})}
          </Container>
          <Container kind='tickets-glue' left='280px' top='50px' rotate='-2deg'
            min-width='220px' min-height='164px'
            drag-controller='tickets' {...this.link ()} >
            {this.getTrip (null, 'pick', {
              TicketId: '42',
              TripId: 't109',
				      Pick: {
        				Time: '11:45',
        				Description: 'Me Mouquin G.',
        				Glyphs:   ['warning', 'bookmark-primary']},
				      Drop: {
        				Time: '13:00',
        				Description: 'Schmidt W.'},
      				Count:    '1x'})}
              {this.getTrip (null, 'drop', {
                TicketId: '43',
                TripId: 't109',
  				      Pick: {
          				Time: '11:45',
          				Description: 'Me Mouquin G.',
          				Glyphs:   ['warning', 'bookmark-primary']},
  				      Drop: {
          				Time: '13:00',
          				Description: 'Schmidt W.'},
        				Count:    '1x'})}
          </Container>
          <Container kind='tickets-glue' left='530px' top='20px' rotate='5deg'
            min-width='220px' min-height='164px'
            drag-controller='tickets' {...this.link ()} >
            {this.getTrips ('trips11', {
				      Pick: {
        				Time: '11:00',
        				Description: 'Migros Pont-Neuf',
        				Glyphs:   ['warning']},
				      Drop: {
        				Time: '11:15',
        				Description: 'Chancellerie'},
      				Count:    '1x'})}
          </Container>
          <Container kind='tickets-glue' left='750px' top='60px' rotate='-10deg'
            min-width='220px' min-height='164px'
            drag-controller='tickets' {...this.link ()} >
            {this.getTrips ('trips12', {
				      Pick: {
        				Time: '10:50',
        				Description: 'Coop St. Laurent'},
				      Drop: {
        				Time: '11:20',
        				Description: 'Dupond J.'},
      				Count:    '1x'})}
          </Container>
          <Container kind='tickets-glue' left='990px' top='50px' rotate='5deg'
            min-width='220px' min-height='164px'
            drag-controller='tickets' {...this.link ()} >
          </Container>
          <Container kind='tickets-glue' left='1210px' top='70px' rotate='-4deg'
            min-width='220px' min-height='164px'
            drag-controller='tickets' {...this.link ()} >
          </Container>
          <Container kind='tickets-glue' left='1450px' top='30px' rotate='0deg'
            min-width='220px' min-height='164px'
            drag-controller='tickets' {...this.link ()} >
          </Container>
          <Container kind='tickets-glue' left='1690px' top='30px' rotate='10deg'
            min-width='220px' min-height='164px'
            drag-controller='tickets' {...this.link ()} >
          </Container>
        </Container>
      </Container>
    );
  }
}
